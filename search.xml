<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>SpringCloud学习笔记（一）</title>
    <url>/2020/06/01/SpringCloud%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/</url>
    <content><![CDATA[<h2 id="系统架构的演变过程"><a href="#系统架构的演变过程" class="headerlink" title="系统架构的演变过程"></a>系统架构的演变过程</h2><blockquote>
<p>1.1 单体应用架构<br>1.2 垂直应用架构<br>1.3 分布式SOA架构<br>1.4 微服务架构</p>
</blockquote>
<hr>
<h2 id="分布式的核心"><a href="#分布式的核心" class="headerlink" title="分布式的核心"></a>分布式的核心</h2><p>在微服务架构中，通常都需要多个服务之间进行远程调用，远程调用包含两个部分：序列化和通信协议。常见的序列化协议包括JSON、XML、bytes等，目前主流的远程调用技术有基于HTTP的RestFul接口和基于TCP的RPC协议。</p>
<h3 id="远程调用"><a href="#远程调用" class="headerlink" title="远程调用"></a>远程调用</h3><h4 id="RestFul接口"><a href="#RestFul接口" class="headerlink" title="RestFul接口"></a>RestFul接口</h4><h4 id="RPC-进程间通信的方式"><a href="#RPC-进程间通信的方式" class="headerlink" title="RPC - 进程间通信的方式"></a>RPC - 进程间通信的方式</h4><blockquote>
<p>区别和联系</p>
</blockquote>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="center">RestFul</th>
<th align="center">RPC</th>
</tr>
</thead>
<tbody><tr>
<td align="center">协议</td>
<td align="center">HTTP</td>
<td align="center">一般是TCP</td>
</tr>
<tr>
<td align="center">性能</td>
<td align="center">略低</td>
<td align="center">高</td>
</tr>
<tr>
<td align="center">灵活性</td>
<td align="center">高</td>
<td align="center">低</td>
</tr>
<tr>
<td align="center">应用</td>
<td align="center">微服务架构</td>
<td align="center">SOA架构</td>
</tr>
</tbody></table>
<blockquote>
<p>分布式中的CAP原理</p>
</blockquote>
<p>A:可用性 - 保持服务可用，多节点<br>C:一致性 - 保证多节点的数据一致<br>P:分区容忍性 - 是否可以多个地方存储</p>
<p>注：不可能同时满足C, A, P<br>AC: 放弃容忍，物理数据库<br>AP：可以短暂不一致， NoSql<br>CP：放弃可用性， zookeeper</p>
<h2 id="常见的微服务框架"><a href="#常见的微服务框架" class="headerlink" title="常见的微服务框架"></a>常见的微服务框架</h2><blockquote>
<p>SpringCloud<br>ServiceComb<br>ZeroC ICE</p>
</blockquote>
]]></content>
      <categories>
        <category>SpringCloud</category>
      </categories>
      <tags>
        <tag>SpringCloud</tag>
        <tag>微服务</tag>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo-NexT主题美化配置</title>
    <url>/2020/06/02/Hexo-NexT%E4%B8%BB%E9%A2%98%E7%BE%8E%E5%8C%96%E9%85%8D%E7%BD%AE/</url>
    <content><![CDATA[<a id="more"></a>

<h1 id="设置头像"><a href="#设置头像" class="headerlink" title="设置头像"></a>设置头像</h1><p>在主题配置文件下修改以下即可，支持cdn和本地文件</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="YML"><figure class="iseeu highlight /yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Sidebar Avatar</span></span><br><span class="line"><span class="attr">avatar:</span></span><br><span class="line">  <span class="comment"># Replace the default image and set the url here.</span></span><br><span class="line">  <span class="attr">url:</span> <span class="string">/images/avatar.jpg</span></span><br><span class="line">  <span class="comment"># If true, the avatar will be dispalyed in circle.</span></span><br><span class="line">  <span class="attr">rounded:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># If true, the avatar will be rotated with the cursor.</span></span><br><span class="line">  <span class="attr">rotated:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure></div>
<h1 id="设置底部不显示Powered-by-Hexo"><a href="#设置底部不显示Powered-by-Hexo" class="headerlink" title="设置底部不显示Powered by Hexo"></a>设置底部不显示Powered by Hexo</h1><p>在主题配置文件找到<code>footer</code>，修改以下即可</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="YML"><figure class="iseeu highlight /yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Powered by Hexo &amp; NexT</span></span><br><span class="line"><span class="attr">powered:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure></div>

<h1 id="设置底部Icon"><a href="#设置底部Icon" class="headerlink" title="设置底部Icon"></a>设置底部Icon</h1><p><strong>实现效果</strong><br><img src="../../../../../images/20200602141722839/20200602033916238.png" alt="images"><br><strong>实现方式</strong><br>在主题配置文件中找到<code>footer</code>，里面的<code>icon</code>，可以自定义其显示的内容，图标详情到<a href="https://fontawesome.com/v4.7.0/icons/" target="_blank" rel="noopener">Fontawesome</a>查看，替换名字即可</p>
<h1 id="开启暗黑模式"><a href="#开启暗黑模式" class="headerlink" title="开启暗黑模式"></a>开启暗黑模式</h1><p><strong>实现效果</strong><br><img src="../../../../../images/20200602141722839/20200602032052189.png" alt="images"><br>在主题配置中找到darkMode修改即可，它可以根据系统自动切换</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="YML"><figure class="iseeu highlight /yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Dark Mode</span></span><br><span class="line"><span class="attr">darkmode:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure></div>

<h1 id="配置社交链接"><a href="#配置社交链接" class="headerlink" title="配置社交链接"></a>配置社交链接</h1><p><strong>实现效果</strong><br><img src="../../../../../images/20200602141722839/20200602034333393.png" alt="images"><br><strong>实现方式</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="YML"><figure class="iseeu highlight /yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Social Links</span></span><br><span class="line"><span class="comment"># Usage: `Key: permalink || icon`</span></span><br><span class="line"><span class="comment"># Key is the link label showing to end users.</span></span><br><span class="line"><span class="comment"># Value before `||` delimiter is the target permalink, value after `||` delimiter is the name of Font Awesome icon.</span></span><br><span class="line"><span class="attr">social:</span></span><br><span class="line">  <span class="attr">GitHub:</span> <span class="string">https://github.com/ckhckhm</span> <span class="string">||</span> <span class="string">github</span></span><br><span class="line">  <span class="attr">E-Mail:</span> <span class="string">mailto:ckhckh85@gmail.com</span> <span class="string">||</span> <span class="string">envelope</span></span><br><span class="line">  <span class="comment">#Weibo: https://weibo.com/yourname || weibo</span></span><br><span class="line">  <span class="comment">#Google: https://plus.google.com/yourname || google</span></span><br><span class="line">  <span class="comment">#Twitter: https://twitter.com/yourname || twitter</span></span><br><span class="line">  <span class="comment">#FB Page: https://www.facebook.com/yourname || facebook</span></span><br><span class="line">  <span class="comment">#StackOverflow: https://stackoverflow.com/yourname || stack-overflow</span></span><br><span class="line">  <span class="comment">#YouTube: https://youtube.com/yourname || youtube</span></span><br><span class="line">  <span class="comment">#Instagram: https://instagram.com/yourname || instagram</span></span><br><span class="line">  <span class="comment">#Skype: skype:yourname?call|chat || skype</span></span><br></pre></td></tr></table></figure></div>

<h1 id="修改主题样式"><a href="#修改主题样式" class="headerlink" title="修改主题样式"></a>修改主题样式</h1><p>NexT提供了四种主题的样式,具体可以自行本地预览，看喜欢哪种</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="YML"><figure class="iseeu highlight /yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Schemes</span></span><br><span class="line"><span class="comment"># scheme: Muse</span></span><br><span class="line"><span class="comment">#scheme: Mist</span></span><br><span class="line"><span class="attr">scheme:</span> <span class="string">Pisces</span></span><br><span class="line"><span class="comment">#scheme: Gemini</span></span><br></pre></td></tr></table></figure></div>

<h1 id="配置返回顶部"><a href="#配置返回顶部" class="headerlink" title="配置返回顶部"></a>配置返回顶部</h1><p>在主题配置文件中修改以下配置</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="YML"><figure class="iseeu highlight /yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">back2top:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Back to top in sidebar.</span></span><br><span class="line">  <span class="attr">sidebar:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Scroll percent label in b2t button.</span></span><br><span class="line">  <span class="attr">scrollpercent:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure></div>

<h1 id="添加RSS"><a href="#添加RSS" class="headerlink" title="添加RSS"></a>添加RSS</h1><p><strong>实现效果</strong><br><img src="../../../../../images/20200602141722839/20200602022545437.png" alt="images"><br><strong>具体实现方法</strong><br>切换到你的Hexo工程目录下，安装Hexo的插件</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">$ npm install hexo-generator-feed --save</span><br></pre></td></tr></table></figure></div>
<p>然后打开Hexo工程目录下的<code>_config.yml</code>, 在里面添加相应配置信息</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="YML"><figure class="iseeu highlight /yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Extensions</span></span><br><span class="line"><span class="comment">## Plugins: https://hexo.io/plugins/</span></span><br><span class="line"><span class="comment">## Themes: https://hexo.io/themes/</span></span><br><span class="line"><span class="attr">plugin:</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">hexo-generator-feed</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Feed/RSS</span></span><br><span class="line"><span class="attr">feed:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">rss2</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">/rss2.xml</span></span><br><span class="line">  <span class="attr">limit:</span> <span class="number">20</span></span><br><span class="line">  <span class="attr">hub:</span></span><br><span class="line">  <span class="attr">content:</span></span><br></pre></td></tr></table></figure></div>
<p>然后进入NexT主题文件中的<code>_config.yml</code>，在里面添加配置如下：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="YML"><figure class="iseeu highlight /yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">rss:</span> <span class="string">rss2.xml</span></span><br></pre></td></tr></table></figure></div>
<p>配置完成后运行：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">$ hexo g</span><br></pre></td></tr></table></figure></div>
<p>注意：如果不生效，可以去NexT主题<code>/themes/next/layout/_partials/sidebarsite-overview.swig</code>添加一下配置信息</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="code"><pre><span class="line">&#123;% if theme.rss %&#125;</span><br><span class="line">   &lt;div class&#x3D;&quot;feed-link motion-element&quot;&gt;</span><br><span class="line">     &lt;a href&#x3D;&quot;&#123;&#123; url_for(theme.rss) &#125;&#125;&quot; rel&#x3D;&quot;alternate&quot;&gt;</span><br><span class="line">       &lt;i class&#x3D;&quot;fa fa-rss&quot;&gt;&lt;&#x2F;i&gt;</span><br><span class="line">       RSS</span><br><span class="line">     &lt;&#x2F;a&gt;</span><br><span class="line">   &lt;&#x2F;div&gt;</span><br><span class="line"> &#123;% endif %&#125;</span><br></pre></td></tr></table></figure></div>
<p><img src="../../../../../images/20200602141722839/20200602023644859.png" alt="images"><br>如果需要配置样式，到<code>/themes/next/css/_common/outline/sidebar/</code>创建<code>sidebar-feed-link.styl</code>文件，添加以下信息：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="code"><pre><span class="line">.site-state &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  justify-content: center;</span><br><span class="line">  line-height: 1.4;</span><br><span class="line">  margin-top: 10px;</span><br><span class="line">  overflow: hidden;</span><br><span class="line">  text-align: center;</span><br><span class="line">  white-space: nowrap;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.site-state-item &#123;</span><br><span class="line">  padding: 0 15px;</span><br><span class="line"></span><br><span class="line">  &amp;:not(:first-child) &#123;</span><br><span class="line">    border-left: 1px solid $site-state-item-border-color;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  a &#123;</span><br><span class="line">    border-bottom: none;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.site-state-item-count &#123;</span><br><span class="line">  display: block;</span><br><span class="line">  font-size: $site-state-item-count-font-size;</span><br><span class="line">  font-weight: 600;</span><br><span class="line">  text-align: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.site-state-item-name &#123;</span><br><span class="line">  color: $site-state-item-name-color;</span><br><span class="line">  font-size: $site-state-item-name-font-size;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>配置好即可，如果需要更加DIY，可以自行修改。<br>重新生成运行就生效了</p>
<h1 id="修改文章底部的-号的标签"><a href="#修改文章底部的-号的标签" class="headerlink" title="修改文章底部的#号的标签"></a>修改文章底部的#号的标签</h1><p><strong>实现效果</strong><br><img src="../../../../../images/20200602141722839/20200602030119901.png" alt="images"><br><strong>实现方法</strong><br>在主题配置文件下修改以下即可</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="YML"><figure class="iseeu highlight /yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">tag_icon:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure></div>

<h1 id="在文章底部增加版权信息"><a href="#在文章底部增加版权信息" class="headerlink" title="在文章底部增加版权信息"></a>在文章底部增加版权信息</h1><p><strong>实现效果</strong><br><img src="../../../../../images/20200602141722839/20200602032403381.png" alt="images"><br>在主题配置文件中找到以下配置进行修改即可</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="YML"><figure class="iseeu highlight /yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Creative Commons 4.0 International License.</span></span><br><span class="line"><span class="comment"># See: https://creativecommons.org/share-your-work/licensing-types-examples</span></span><br><span class="line"><span class="comment"># Available values of license: by | by-nc | by-nc-nd | by-nc-sa | by-nd | by-sa | zero</span></span><br><span class="line"><span class="comment"># You can set a language value if you prefer a translated version of CC license, e.g. deed.zh</span></span><br><span class="line"><span class="comment"># CC licenses are available in 39 languages, you can find the specific and correct abbreviation you need on https://creativecommons.org</span></span><br><span class="line"><span class="attr">creative_commons:</span></span><br><span class="line">  <span class="attr">license:</span> <span class="string">by-nc-sa</span></span><br><span class="line">  <span class="attr">sidebar:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">post:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">language:</span></span><br></pre></td></tr></table></figure></div>

<h1 id="实现统计"><a href="#实现统计" class="headerlink" title="实现统计"></a>实现统计</h1><p><strong>实现效果</strong><br><img src="../../../../../images/20200602141722839/20200602034523473.png" alt="images"><br><strong>具体实现方式</strong><br>在Hexo根目录下安装</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">$ npm install hexo-symbols-count-time</span><br></pre></td></tr></table></figure></div>
<p>在Hexo的配置文件添加以下配置信息</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="YML"><figure class="iseeu highlight /yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">symbols_count_time:</span></span><br><span class="line">  <span class="attr">symbols:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">time:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">total_symbols:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">total_time:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">exclude_codeblock:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">awl:</span> <span class="number">4</span></span><br><span class="line">  <span class="attr">wpm:</span> <span class="number">275</span></span><br><span class="line">  <span class="attr">suffix:</span> <span class="string">"mins."</span></span><br></pre></td></tr></table></figure></div>
<p>再到NexT配置文件下配置</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="YML"><figure class="iseeu highlight /yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">symbols_count_time:</span></span><br><span class="line">  <span class="attr">separated_meta:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">item_text_post:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">item_text_total:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure></div>
<p>重新生成运行即可</p>
<p>详情请看 [hexo-symbols-count-time]<br>[hexo-symbols-count-time]: <a href="https://github.com/theme-next/hexo-symbols-count-time" target="_blank" rel="noopener">https://github.com/theme-next/hexo-symbols-count-time</a></p>
<h1 id="添加“阅读全文”按钮"><a href="#添加“阅读全文”按钮" class="headerlink" title="添加“阅读全文”按钮"></a>添加“阅读全文”按钮</h1><p>设置首页文章摘要形式显示，在主题配置文件中，修改以下配置</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="YML"><figure class="iseeu highlight /yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Read more button</span></span><br><span class="line"><span class="comment"># If true, the read more button will be displayed in excerpt section.</span></span><br><span class="line"><span class="attr">read_more_btn:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure></div>

<h1 id="评论功能"><a href="#评论功能" class="headerlink" title="评论功能"></a>评论功能</h1><p><strong>实现效果</strong><br><img src="../../../../../images/20200602141722839/20200602032608855.png" alt="images"><br><strong>具体实现</strong><br>我采用的是<code>LiveRe</code>，可以参考这篇文章：[为 Hexo 博客主题 NexT 添加 LiveRe 评论支持]<br>[为 Hexo 博客主题 NexT 添加 LiveRe 评论支持]: <a href="http://blog.smoker.cc/web/add-comments-livere-for-hexo-theme-next.html" target="_blank" rel="noopener">http://blog.smoker.cc/web/add-comments-livere-for-hexo-theme-next.html</a><br>其中NexT也提供了很多评论板块的支持</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="code"><pre><span class="line">changyan | disqus | disqusjs | gitalk | livere | valine</span><br></pre></td></tr></table></figure></div>

<h1 id="分享功能"><a href="#分享功能" class="headerlink" title="分享功能"></a>分享功能</h1><p><strong>实现效果</strong><br><img src="../../../../../images/20200602141722839/20200602035209499.png" alt="images"><br><strong>具体实现方式</strong><br>到Hexo的根目录安装</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">$ npm install theme-next/hexo-next-share</span><br></pre></td></tr></table></figure></div>
<p>然后进入主题配置文件中，添加以下配置</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="YML"><figure class="iseeu highlight /yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># NeedMoreShare2</span></span><br><span class="line"><span class="comment"># Dependencies: https://github.com/theme-next/theme-next-needmoreshare2</span></span><br><span class="line"><span class="comment"># iconStyle: default | box</span></span><br><span class="line"><span class="comment"># boxForm: horizontal | vertical</span></span><br><span class="line"><span class="comment"># position: top / middle / bottom + Left / Center / Right</span></span><br><span class="line"><span class="comment"># networks:</span></span><br><span class="line"><span class="comment"># Weibo,Wechat,Douban,QQZone,Twitter,Facebook,Linkedin,Mailto,Reddit,Delicious,StumbleUpon,Pinterest,</span></span><br><span class="line"><span class="comment"># GooglePlus,Tumblr,GoogleBookmarks,Newsvine,Evernote,Friendfeed,Vkontakte,Odnoklassniki,Mailru</span></span><br><span class="line"><span class="attr">needmoreshare:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">cdn:</span></span><br><span class="line">    <span class="attr">js:</span> <span class="string">//cdn.jsdelivr.net/gh/theme-next/theme-next-needmoreshare2@1/needsharebutton.min.js</span></span><br><span class="line">    <span class="attr">css:</span> <span class="string">//cdn.jsdelivr.net/gh/theme-next/theme-next-needmoreshare2@1/needsharebutton.min.css</span></span><br><span class="line">  <span class="attr">postbottom:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">options:</span></span><br><span class="line">      <span class="attr">iconStyle:</span> <span class="string">box</span></span><br><span class="line">      <span class="attr">boxForm:</span> <span class="string">horizontal</span></span><br><span class="line">      <span class="attr">position:</span> <span class="string">bottomCenter</span></span><br><span class="line">      <span class="attr">networks:</span> <span class="string">Weibo,Wechat,Douban,QQZone,Twitter,Facebook,Linkedin,Mailto,Reddit,GooglePlus</span></span><br><span class="line">  <span class="attr">float:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">options:</span></span><br><span class="line">      <span class="attr">iconStyle:</span> <span class="string">box</span></span><br><span class="line">      <span class="attr">boxForm:</span> <span class="string">horizontal</span></span><br><span class="line">      <span class="attr">position:</span> <span class="string">middleRight</span></span><br><span class="line">      <span class="attr">networks:</span> <span class="string">Weibo,Wechat,Douban,QQZone,Twitter,Facebook,Linkedin,Mailto,Reddit,GooglePlus</span></span><br></pre></td></tr></table></figure></div>
<p>重新生成既可以看到效果</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">$ hexo clean &amp;&amp; hexo g &amp;&amp; hexo s</span><br></pre></td></tr></table></figure></div>

<p>详情请看: [Hexo NexT Share]<br>[Hexo NexT Share]: <a href="https://github.com/theme-next/hexo-next-share" target="_blank" rel="noopener">https://github.com/theme-next/hexo-next-share</a></p>
]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
        <tag>NexT</tag>
      </tags>
  </entry>
  <entry>
    <title>kubernetes初体验 --- 基于arm架构的CentOS7.x部署</title>
    <url>/2021/12/17/kubernetes%E5%88%9D%E4%BD%93%E9%AA%8C%EF%BC%88%E4%B8%80%EF%BC%89/</url>
    <content><![CDATA[<a id="more"></a>

<h2 id="设置主机名称"><a href="#设置主机名称" class="headerlink" title="设置主机名称"></a>设置主机名称</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">查看Linux内核的版本</span></span><br><span class="line">uname -r</span><br><span class="line">4.18.0-80.7.2.el7.aarch64</span><br><span class="line"></span><br><span class="line">或者使用 uname -a</span><br><span class="line">Linux kc-linux 4.18.0-80.7.2.el7.aarch64 #1 SMP Thu Sep 12 16:13:20 UTC 2019 aarch64 aarch64 aarch64 GNU/Linux</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">如需要修改主机名称</span></span><br><span class="line">vim /etc/hostname</span><br></pre></td></tr></table></figure></div>

<h2 id="配置k8s的源"><a href="#配置k8s的源" class="headerlink" title="配置k8s的源"></a>配置k8s的源</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">cat &lt;&lt;EOF &gt; /etc/yum.repos.d/kubernetes.repo</span><br><span class="line">[kubernetes]</span><br><span class="line">name=kubernetes</span><br><span class="line">baseurl=https://mirrors.tuna.tsinghua.edu.cn/kubernetes/yum/repos/kubernetes-el7-$basearch</span><br><span class="line">enabled=1</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">清除缓存</span></span><br><span class="line">yum clean all</span><br><span class="line"></span><br><span class="line">yum makecache</span><br></pre></td></tr></table></figure></div>

<h2 id="安装docker"><a href="#安装docker" class="headerlink" title="安装docker"></a>安装docker</h2><p><strong>docker的版本需要和kubectl的大版本一致</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">列出kubectl可用的版本信息</span></span><br><span class="line">yum list kubectl --showduplicates | sort -r</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">列出信息如下:</span></span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line">Loaded plugins: fastestmirror</span><br><span class="line">kubectl.aarch64                      1.9.9-0                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.9.8-0                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.9.7-0                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.9.6-0                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.9.5-0                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.9.4-0                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.9.3-0                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.9.2-0                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.9.11-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.9.1-0                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.9.10-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.9.0-0                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.8.9-0                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.8.8-0                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.8.7-0                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.8.6-0                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.8.5-0                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.8.4-0                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.8.3-0                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.8.2-0                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.8.15-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.8.14-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.8.13-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.8.12-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.8.11-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.8.1-0                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.8.10-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.8.0-0                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.7.9-0                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.7.8-1                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.7.7-1                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.7.6-1                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.7.5-0                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.7.4-0                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.7.3-1                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.7.2-0                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.7.16-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.7.15-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.7.14-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.7.11-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.7.1-0                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.7.10-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.7.0-0                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.6.9-0                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.6.8-0                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.6.7-0                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.6.6-0                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.6.5-0                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.6.4-0                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.6.3-0                         kubernetes</span><br><span class="line">kubectl.aarch64                      1.6.13-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.6.12-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.6.11-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.6.10-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.23.0-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.22.4-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.22.3-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.22.2-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.22.1-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.22.0-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.21.8-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.21.7-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.21.6-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.21.5-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.21.4-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.21.3-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.21.2-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.21.1-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.21.0-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.20.9-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.20.8-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.20.7-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.20.6-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.20.5-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.20.4-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.20.2-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.20.14-0                       kubernetes</span><br><span class="line">kubectl.aarch64                      1.20.13-0                       kubernetes</span><br><span class="line">kubectl.aarch64                      1.20.12-0                       kubernetes</span><br><span class="line">kubectl.aarch64                      1.20.11-0                       kubernetes</span><br><span class="line">kubectl.aarch64                      1.20.1-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.20.10-0                       kubernetes</span><br><span class="line">kubectl.aarch64                      1.20.0-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.19.9-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.19.8-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.19.7-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.19.6-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.19.5-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.19.4-0                        kubernetes</span><br><span class="line">kubectl.aarch64                      1.19.3-0                        kubernetes</span><br></pre></td></tr></table></figure></div>

<p><strong>这里选择1.19.3的版本进行安装，那么安装的docker对应版本</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">yum list docker-ce --showduplicates | sort -r</span><br><span class="line"><span class="meta">#</span><span class="bash">输出一下信息</span></span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line">Loaded plugins: fastestmirror</span><br><span class="line">docker-ce.aarch64           3:20.10.9-3.el7                    docker-ce-stable</span><br><span class="line">docker-ce.aarch64           3:20.10.8-3.el7                    docker-ce-stable</span><br><span class="line">docker-ce.aarch64           3:20.10.7-3.el7                    docker-ce-stable</span><br><span class="line">docker-ce.aarch64           3:20.10.6-3.el7                    docker-ce-stable</span><br><span class="line">docker-ce.aarch64           3:20.10.5-3.el7                    docker-ce-stable</span><br><span class="line">docker-ce.aarch64           3:20.10.4-3.el7                    docker-ce-stable</span><br><span class="line">docker-ce.aarch64           3:20.10.3-3.el7                    docker-ce-stable</span><br><span class="line">docker-ce.aarch64           3:20.10.2-3.el7                    docker-ce-stable</span><br><span class="line">docker-ce.aarch64           3:20.10.1-3.el7                    docker-ce-stable</span><br><span class="line">docker-ce.aarch64           3:20.10.12-3.el7                   docker-ce-stable</span><br><span class="line">docker-ce.aarch64           3:20.10.11-3.el7                   docker-ce-stable</span><br><span class="line">docker-ce.aarch64           3:20.10.10-3.el7                   docker-ce-stable</span><br><span class="line">docker-ce.aarch64           3:20.10.0-3.el7                    docker-ce-stable</span><br><span class="line">docker-ce.aarch64           3:19.03.9-3.el7                    docker-ce-stable</span><br><span class="line">docker-ce.aarch64           3:19.03.9-3.el7                    @docker-ce-stable</span><br><span class="line">docker-ce.aarch64           3:19.03.8-3.el7                    docker-ce-stable</span><br><span class="line">docker-ce.aarch64           3:19.03.7-3.el7                    docker-ce-stable</span><br><span class="line">docker-ce.aarch64           3:19.03.6-3.el7                    docker-ce-stable</span><br><span class="line">docker-ce.aarch64           3:19.03.5-3.el7                    docker-ce-stable</span><br><span class="line">docker-ce.aarch64           3:19.03.4-3.el7                    docker-ce-stable</span><br><span class="line">docker-ce.aarch64           3:19.03.3-3.el7                    docker-ce-stable</span><br><span class="line">docker-ce.aarch64           3:19.03.2-3.el7                    docker-ce-stable</span><br><span class="line">docker-ce.aarch64           3:19.03.15-3.el7                   docker-ce-stable</span><br><span class="line">docker-ce.aarch64           3:19.03.14-3.el7                   docker-ce-stable</span><br><span class="line">docker-ce.aarch64           3:19.03.1-3.el7                    docker-ce-stable</span><br><span class="line">docker-ce.aarch64           3:19.03.13-3.el7                   docker-ce-stable</span><br><span class="line">docker-ce.aarch64           3:19.03.12-3.el7                   docker-ce-stable</span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">安装指定版本的docker</span></span><br><span class="line">sudo yum install docker-ce-19.03.9 docker-ce-cli-19.03.9 containerd.io</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">启动docker</span></span><br><span class="line">sudo systemctl start docker</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">验证docker</span></span><br><span class="line">docker version</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">输出以下信息</span></span><br><span class="line">Client: Docker Engine - Community</span><br><span class="line"> Version:           19.03.9</span><br><span class="line"> API version:       1.40</span><br><span class="line"> Go version:        go1.13.10</span><br><span class="line"> Git commit:        9d98839</span><br><span class="line"> Built:             Fri May 15 00:25:47 2020</span><br><span class="line"> OS/Arch:           linux/arm64</span><br><span class="line"> Experimental:      false</span><br><span class="line"></span><br><span class="line">Server: Docker Engine - Community</span><br><span class="line"> Engine:</span><br><span class="line">  Version:          19.03.9</span><br><span class="line">  API version:      1.40 (minimum version 1.12)</span><br><span class="line">  Go version:       go1.13.10</span><br><span class="line">  Git commit:       9d98839</span><br><span class="line">  Built:            Fri May 15 00:24:27 2020</span><br><span class="line">  OS/Arch:          linux/arm64</span><br><span class="line">  Experimental:     false</span><br><span class="line"> containerd:</span><br><span class="line">  Version:          1.4.12</span><br><span class="line">  GitCommit:        7b11cfaabd73bb80907dd23182b9347b4245eb5d</span><br><span class="line"> runc:</span><br><span class="line">  Version:          1.0.2</span><br><span class="line">  GitCommit:        v1.0.2-0-g52b36a2</span><br><span class="line"> docker-init:</span><br><span class="line">  Version:          0.18.0</span><br><span class="line">  GitCommit:        fec3683</span><br></pre></td></tr></table></figure></div>

<h2 id="配置iptables"><a href="#配置iptables" class="headerlink" title="配置iptables"></a>配置iptables</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">cat &lt;&lt;EOF &gt;  /etc/sysctl.d/k8s.conf</span><br><span class="line">net.bridge.bridge-nf-call-ip6tables = 1</span><br><span class="line">net.bridge.bridge-nf-call-iptables = 1</span><br><span class="line">vm.swappiness=0</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">让上述配置命令生效</span></span><br><span class="line">sysctl --system</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">如果执行出现：</span></span><br><span class="line">sysctl: cannot stat /proc/sys/net/bridge/bridge-nf-call-ip6tables: No such file or directory</span><br><span class="line">sysctl: cannot stat /proc/sys/net/bridge/bridge-nf-call-iptables: No such file or directory</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">解决方法：</span></span><br><span class="line">modprobe br_netfilter</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">然后再执行</span></span><br><span class="line">sysctl --system</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">输出的都是1</span></span><br><span class="line">cat /proc/sys/net/bridge/bridge-nf-call-ip6tables</span><br><span class="line">cat /proc/sys/net/bridge/bridge-nf-call-iptables</span><br></pre></td></tr></table></figure></div>



<h2 id="安装kubelet-kubeadm-kubectl"><a href="#安装kubelet-kubeadm-kubectl" class="headerlink" title="安装kubelet, kubeadm, kubectl"></a>安装kubelet, kubeadm, kubectl</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">安装最新版本,也可安装指定版本</span></span><br><span class="line">yum install -y kubelet kubeadm kubectl</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">安装指定版本的kubelet,kubeadm,kubectl</span></span><br><span class="line">yum install -y kubelet-1.19.3-0 kubeadm-1.19.3-0 kubectl-1.19.3-0</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">查看kubelet版本</span></span><br><span class="line">kubelet --version</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">信息如下：</span></span><br><span class="line">Kubernetes v1.19.3</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">查看kubeadm版本</span></span><br><span class="line">kubeadm version</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">版本信息：</span></span><br><span class="line">kubeadm version: &amp;version.Info&#123;Major:"1", Minor:"19", GitVersion:"v1.19.3", GitCommit:"1e11e4a2108024935ecfcb2912226cedeafd99df", GitTreeState:"clean", BuildDate:"2020-10-14T12:47:53Z", GoVersion:"go1.15.2", Compiler:"gc", Platform:"linux/arm64"&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="启动并把上面的服务加入自启"><a href="#启动并把上面的服务加入自启" class="headerlink" title="启动并把上面的服务加入自启"></a>启动并把上面的服务加入自启</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">重新加载配置文件</span></span><br><span class="line">systemctl daemon-reload</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">启动kubelet</span></span><br><span class="line">systemctl start kubelet</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">设置开机自启</span></span><br><span class="line">systemctl enable kubelet</span><br><span class="line">systemctl enable docker</span><br></pre></td></tr></table></figure></div>

<h2 id="kubeadm工具简介"><a href="#kubeadm工具简介" class="headerlink" title="kubeadm工具简介"></a>kubeadm工具简介</h2><p><a href="https://kubernetes.io/docs/reference/setup-tools/kubeadm/" target="_blank" rel="noopener">Kubeadm</a>是一个提供了 <code>[kubeadm init]</code> 和 <code>[kubeadm join]</code> 的工具， 作为创建 <a href="https://kubernetes.io/docs/home/" target="_blank" rel="noopener">Kubernetes </a>集群的 “快捷途径” 的最佳实践。</p>
<h2 id="初始化k8s集群Master"><a href="#初始化k8s集群Master" class="headerlink" title="初始化k8s集群Master"></a>初始化k8s集群Master</h2><p><strong><em>命令简介：</em></strong></p>
<ul>
<li><code>--image-repository string</code> : 默认是 “k8s.gcr.io”。设置用于拉取镜像的容器仓库，国内的话需要更换国内的源，不然不可以直接下载镜像，以下已经替换了阿里云的源。</li>
<li><code>--apiserver-advertise-address string</code>：API服务器监听的IP地址，如果未设置，则使用默认网络接口。这里设置的地址需要是服务器的内网地址，如果是外网的IP地址可能存在一些问题。</li>
<li><code>--kubernetes-version string</code>：选择一个Kubernetes的版本，默认是 “stable-1”。</li>
<li><code>--pod-network-cidr string</code>： 指明 pod 网络可以使用的 IP 地址段。</li>
<li><code>--service-cidr string</code>：默认值为：”10.96.0.0/12”，为服务的虚拟IP地址另外制定IP地址段</li>
<li>其余参数参考<a href="https://kubernetes.io/docs/reference/setup-tools/kubeadm/kubeadm-init/" target="_blank" rel="noopener">kubeadm init</a></li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">kubeadm init --image-repository registry.aliyuncs.com/google_containers --apiserver-advertise-address=192.168.0.58 --kubernetes-version=v1.19.3 --pod-network-cidr=10.244.0.0/16 --service-cidr=10.1.0.0/16</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 打印信息如下：</span></span><br><span class="line">...</span><br><span class="line">our Kubernetes control-plane has initialized successfully!</span><br><span class="line"></span><br><span class="line">To start using your cluster, you need to run the following as a regular user:</span><br><span class="line"></span><br><span class="line">  mkdir -p $HOME/.kube</span><br><span class="line">  sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config</span><br><span class="line">  sudo chown $(id -u):$(id -g) $HOME/.kube/config</span><br><span class="line"></span><br><span class="line">You should now deploy a pod network to the cluster.</span><br><span class="line">Run "kubectl apply -f [podnetwork].yaml" with one of the options listed at:</span><br><span class="line">  https://kubernetes.io/docs/concepts/cluster-administration/addons/</span><br><span class="line"></span><br><span class="line">Then you can join any number of worker nodes by running the following on each as root:</span><br><span class="line"></span><br><span class="line">kubeadm join 192.168.0.58:6443 --token r5rf22.ptjljxjlipt.....hyo \</span><br><span class="line">    --discovery-token-ca-cert-hash sha256:3e69484.....a6e93d170a02</span><br></pre></td></tr></table></figure></div>

<p><strong><a href="https://kubernetes.io/docs/reference/setup-tools/kubeadm/kubeadm-join/" target="_blank" rel="noopener">kubeadm join</a> 此命令用来初始化 Kubernetes 工作节点并将其加入集群</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">mkdir -p $HOME/.kube</span><br><span class="line">sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config</span><br><span class="line">sudo chown $(id -u):$(id -g) $HOME/.kube/config</span><br></pre></td></tr></table></figure></div>



<h2 id="安装flannel"><a href="#安装flannel" class="headerlink" title="安装flannel"></a>安装flannel</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 创建文件夹</span></span><br><span class="line">mkdir flannel &amp;&amp; cd flannel</span><br><span class="line"><span class="meta">#</span><span class="bash"> 下载文件</span></span><br><span class="line">curl -O https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">创建flannel网络插件</span></span><br><span class="line">kubectl apply -f kube-flannel.yml</span><br></pre></td></tr></table></figure></div>



<h2 id="查看集群节点"><a href="#查看集群节点" class="headerlink" title="查看集群节点"></a>查看集群节点</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看节点</span></span><br><span class="line">kubectl get node</span><br><span class="line">NAME        STATUS   ROLES    AGE   VERSION</span><br><span class="line">kc-linux   Ready    master   4m38s   v1.19.3</span><br></pre></td></tr></table></figure></div>



<h2 id="将节点添加到k8s集群中"><a href="#将节点添加到k8s集群中" class="headerlink" title="将节点添加到k8s集群中"></a>将节点添加到k8s集群中</h2><p><strong>参考上面在节点上安装好docker, kubelet, kubectl, kubeadm, 然后执行初始化输出的 kubeadm join….</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 节点加入成功后，在master上查看</span></span><br><span class="line">kubectl get node</span><br></pre></td></tr></table></figure></div>







]]></content>
      <categories>
        <category>kubernetes</category>
      </categories>
      <tags>
        <tag>docker</tag>
        <tag>kubernetes</tag>
        <tag>云原生</tag>
        <tag>集群</tag>
        <tag>Linux</tag>
      </tags>
  </entry>
</search>
